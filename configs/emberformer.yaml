# =========================
# EmberFormer master config
# Phase 0/1
# =========================

global:
  seed: 42
  cudnn_benchmark: true

data:
  data_dir: "~/data/deep_crown_dataset/organized_spreads"
  sequence_length: 3
  batch_size: 4
  num_workers: 4
  pin_memory: true
  drop_last: false
  shuffle: true

  collate: left_pad_time
  enforce_spatial_size: null
  resize_mode: pad
  constant_pad_value: 0

encoding:
  fire_channel: 1
  fire_value: 231
  isochrone_channel: 1
  isochrone_value: 231

weather:
  folder: "landscape/Weathers"
  history_csv: "landscape/WeatherHistory.csv"
  ws_col: "WS"
  wd_col: "WD"

wandb:
  enabled: true
  mode: online                # or offline
  project: "emberformer"
  entity: ""

  # leave run_name empty to use the template
  run_name:
  run_name_template: "{script}-{model}-T{seq}-lr{lr}-{time}"

  # Optional manual tags get merged with auto-tags below
  tags: []
  auto_tags: true             # adds: script:{script}, model:{model}, T:{seq}

  # preview controls
  log_batch_preview: true
  max_preview_images: 2
  preview_size: 160

  # reduce overhead early on
  watch: false
  log_artifacts: false

train:
  model: copy_last            # copy_last | conv_head2d | tiny3d
  epochs: 1
  lr: 1e-3
  weight_decay: 0.0
  log_images_every: 200

checks:
  sample_count: 16
  fail_on_mixed_hw: true
  assert_ws_wd_present: true
  assert_frames_match: true


patchify_on_disk:
  enabled: true
  cache_dir: "~/data/emberformer/patch_cache"
  patch_size: 16
  stride: 16                 # unused for now (non-overlapping)
  pad_mode: "strict"         # <â€” assert H%P==0 and W%P==0, no padding
  log_artifact: true

  progress_use_tqdm: true
  progress_log_every: 5
  progress_log_to_wandb: true
  preview_n: 1
